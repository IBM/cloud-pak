patch sts rabbitmq-ha --patch '"spec": {"updateStrategy": {"type": "RollingUpdate" }, "template": {"spec": {"containers": [{"name": "wdp-rabbitmq","image": "{{.DockerRegistryPrefix}}/rabbitmq:3.8.9-118", "volumeMounts": [{"name":"config", "readOnly": false, "mountPath":"/etc/rabbitmq"}]}], "initContainers": [{"name": "copy-rabbitmq-config","image": "{{.DockerRegistryPrefix}}/wkc-init-container:1.0.124"}]}}}'
patch sts redis-ha-server --patch '{"spec": {"template": {"spec": {"containers": [{"name": "redis","image": "{{.DockerRegistryPrefix}}/redis:6.0.8-121", "resources": {"limits": {"memory": "2Gi"}}}, {"name": "sentinel","image": "{{.DockerRegistryPrefix}}/redis:6.0.8-121"}]}}}}'
patch sts wdp-couchdb --patch '{"spec": {"template": {"spec": {"containers": [{"name": "couchdb","image": "{{.DockerRegistryPrefix}}/couchdb3:3.1.1-103"}], "initContainers": [{"name": "init-copy","image": "{{.DockerRegistryPrefix}}/wkc-init-container:1.0.124"}]}}}}'
patch cm redis-ha-configmap -p '{"data":{ "redis.conf":"dir \"/data\"\nmaxmemory \"2gb\"\nmaxmemory-policy volatile-lru\nmin-slaves-max-lag 5\nmin-slaves-to-write 1\nrdbchecksum yes\nrdbcompression yes\nrepl-diskless-sync yes\nsave 900 1\n"}}'
patch deployment redis-ha-haproxy --patch '{"spec": {"template": {"spec": {"containers": [{"name": "haproxy","image": "{{.DockerRegistryPrefix}}/haproxy:2.2.5-38"}]}}}}'
