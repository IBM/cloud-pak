patch deployment wdp-profiling --patch '{"spec": {"template": {"spec": {"containers": [{"name": "wdp-profiling","image": "{{.DockerRegistryPrefix}}/wdp-profiling:3.2.21"}]}}}}'
patch deployment wdp-profiling-messaging --patch '{"spec": {"template": {"spec": {"containers": [{"name": "wdp-profiling-messaging","image": "{{.DockerRegistryPrefix}}/wdp-profiling-messaging:3.2.23"}]}}}}'
patch deployment wdp-profiling-ui --patch '{"spec": {"template": {"spec": {"containers": [{"name": "wdp-profiling-ui","image": "{{.DockerRegistryPrefix}}/wdp-profiling-ui:3.2.29"}]}}}}'
patch deployment wkc-glossary-service --patch '{"spec": {"template": {"spec": {"containers": [{"name": "wkc-glossary-service","image": "{{.DockerRegistryPrefix}}/wkc-glossary-service:3.3.23"}], "volumes": [{ "name": "wdp-certs", "projected": { "sources" : [{"secret":{"items": [{"key": "wdp-db2-ca.crt", "path": "wdp-db2-ca.pem" }], "name": "wdp-db2-cert", "optional": true }},{"secret":{"items": [{"key": "cert.pem", "path": "rabbitmq.cert.pem" }], "name": "rabbitmq-ha-cert", "optional": true }},{"secret":{"items": [{"key": "certificate.pem", "path": "nternal-nginx.cert.pem" }], "name": "internal-nginx-svc-tls", "optional": true }}]}}]}}}}'
set env deployment/wkc-glossary-service BG_REDIS_ENABLED=true TRUST_ALL_SSL_CERT=false BG_JWT_AUTHENTICATION_PROVIDER_IMPL=com.ibm.wdp.bg.auth.Cp4dAuthenticationProvider BG_ROLES_AUTHORIZATION_IMPL=com.ibm.wdp.bg.auth.Cp4dAuthorizationProvider PUBLIC_CLOUD_MODE_ENABLED=false BG_DB2_ADMIN_USER=DB2INST1 BG_DB2_ADMIN_GROUP=DB2IADM1
patch deployment wkc-gov-ui --patch '{"spec": {"template": {"spec": {"containers": [{"name": "wkc-gov-ui","image": "{{.DockerRegistryPrefix}}/wkc-gov-ui:3.3.22"}]}}}}'
set env deployment/wkc-gov-ui BM_APP_VERSION=3.3.22
patch deployment metadata-discovery --patch '{"spec": {"template": {"spec": {"containers": [{"name": "metadata-discovery","image": "{{.DockerRegistryPrefix}}/metadata-discovery:1.0.1113"}]}}}}'
patch deployment wdp-activities --patch '{"spec": {"template": {"spec": {"containers": [{"name": "wdp-activities","image": "{{.DockerRegistryPrefix}}/wdp-activities:2.0.39"}]}}}}'
patch deployment dataconn-engine-service --patch '{"spec": {"template": {"spec": {"containers": [{"name": "dataconn-engine-service","image": "{{.DockerRegistryPrefix}}/dataconn-engine-service:4.0.88"}]}}}}'
patch deployment dataconn-engine-spark-cluster --patch '{"spec": {"template": {"spec": {"containers": [{"name": "dataconn-engine-spark-cluster","image": "{{.DockerRegistryPrefix}}/dataconn-engine-spark-cluster:4.0.88"}]}}}}'
patch deployment dataconn-engine-opdiscovery --patch '{"spec": {"template": {"spec": {"containers": [{"name": "dataconn-engine-opdiscovery","image": "{{.DockerRegistryPrefix}}/dataconn-engine-opdiscovery:2.0.52"}]}}}}'
patch deployment wdp-lineage --patch '{"spec": {"template": {"spec": {"containers": [{"name": "wdp-lineage","image": "{{.DockerRegistryPrefix}}/wdp-lineage:3.2.40"}]}}}}'
patch deployment wdp-policy-service --patch '{"spec": {"template": {"spec": {"containers": [{"name": "wdp-policy-service","image": "{{.DockerRegistryPrefix}}/wdp-policy-service:3.5.300"}]}}}}'
set env deployment/wdp-policy-service TS_USE_SERVICEID_IMPERSONATION=true
patch deployment wdp-search --patch '{"spec": {"template": {"spec": {"containers": [{"name": "wdp-search","image": "{{.DockerRegistryPrefix}}/wdp-search:1.0.464"}]}}}}'
patch deployment wkc-workflow-service --patch '{"spec": {"template": {"spec": {"containers": [{"name": "wkc-workflow-service","image": "{{.DockerRegistryPrefix}}/wkc-workflow-service:3.2.1"}]}}}}'
patch ConfigMap wkc-base2-routes --patch '{"metadata": { "labels": { "icpdata_addon_version": "3.0.1.4-7" } }, "data": { "nginx.conf": "set_by_lua $nsdomain \"return os.getenv(\\\"NS_DOMAIN\\\")\";\nlocation /v2/dataconn/discovery {\n  set $dataconn_engine_opdiscovery dataconn-engine-opdiscovery.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$dataconn_engine_opdiscovery:443;\n}\nlocation /v2/dataconn/engine {\n  set $dataconn_engine_service dataconn-engine-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$dataconn_engine_service:443;\n}\nlocation /v2/activities {\n  set $wdp_activities wdp-activities.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_activities:443;\n}\nlocation /v2/data_flows {\n  set $wdp_activities wdp-activities.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_activities:443;\n}\nlocation /quality {\n  set $wkc_gov_ui wkc-gov-ui.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_gov_ui:443;\n}\nlocation /gov/api/workflow/execute {\n  set $wkc_gov_ui wkc-gov-ui.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_gov_ui:443;\n  proxy_read_timeout 30m;\n}\nlocation ~ ^\\/gov\\/api\\/rds\\/[a-fA-F0-9_\\-]+\\/[a-fA-F0-9_\\-]+\\/workflow\\/?$ {\n  set $wkc_gov_ui wkc-gov-ui.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_gov_ui:443;\n  proxy_read_timeout 30m;\n}\nlocation /gov/api/addRDV {\n  set $wkc_gov_ui wkc-gov-ui.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_gov_ui:443;\n  proxy_read_timeout 30m;\n}\nlocation /gov/api/updateRDV {\n  set $wkc_gov_ui wkc-gov-ui.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_gov_ui:443;\n  proxy_read_timeout 30m;\n}\nlocation /gov/api/deleteRDV {\n  set $wkc_gov_ui wkc-gov-ui.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_gov_ui:443;\n  proxy_read_timeout 30m;\n}\nlocation /gov/api/downloadRDVs {\n  set $wkc_gov_ui wkc-gov-ui.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_gov_ui:443;\n  proxy_read_timeout 30m;\n}\nlocation /gov/api/importReferenceData {\n  set $wkc_gov_ui wkc-gov-ui.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_gov_ui:443;\n  proxy_read_timeout 30m;\n  client_max_body_size 100M;\n}\nlocation /gov/api/import {\n  set $wkc_gov_ui wkc-gov-ui.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_gov_ui:443;\n  proxy_read_timeout 30m;\n}\nlocation /gov {\n  set $wkc_gov_ui wkc-gov-ui.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_gov_ui:443;\n}\nlocation /v3/reference_data {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n  proxy_read_timeout 30m;\n}\nlocation /v3/data_classes/publish {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n  proxy_read_timeout 30m;\n}\nlocation /v3/data_classes {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n  proxy_read_timeout 30m;\n}\nlocation /v3/policies/publish {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n  proxy_read_timeout 30m;\n}\nlocation /v3/policies {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n}\nlocation /v3/rules/publish {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n  proxy_read_timeout 30m;\n}\nlocation /v3/rules {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n}\nlocation /v3/categories {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n}\nlocation /v3/tags {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n}\nlocation /v3/glossary_terms/publish {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n  proxy_read_timeout 30m;\n}\nlocation /v3/glossary_terms {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n}\nlocation /v3/classifications/publish {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n  proxy_read_timeout 30m;\n}\nlocation /v3/classifications {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n}\nlocation /glossary_terms_api {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n}\nlocation /v2/search {\n  set $wdp_search wdp-search.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_search:443;\n}\nlocation /v2/recommendations {\n  set $wdp_search wdp-search.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_search:443;\n}\nlocation /v2/data_profiles {\n  set $wdp_profiling wdp-profiling.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_profiling:443;\n  proxy_read_timeout 30m;\n}\nlocation /v2/data_classes {\n  set $wdp_profiling wdp-profiling.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_profiling:443;\n  proxy_read_timeout 30m;\n}\nlocation /v2/profiling_messaging {\n  set $wdp_profiling_messaging wdp-profiling-messaging.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_profiling_messaging:443;\n}\nlocation /profiles {\n  set $wdp_profiling_ui wdp-profiling-ui.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_profiling_ui:443;\n}\nlocation /v2/data_discoveries {\n  set $metadata_discovery metadata-discovery.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$metadata_discovery:443;\n}\nlocation /v3/workflow {\n  set $wkc_workflow_service wkc-workflow-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_set_header X-Forwarded-Port 31843;\n  proxy_pass https://$wkc_workflow_service:443;\n}\nlocation /v3/workflows {\n  set $wkc_workflow_service wkc-workflow-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_set_header X-Forwarded-Port 31843;\n  proxy_pass https://$wkc_workflow_service:443;\n}\nlocation ~ ^\\/v3\\/workflow_user_tasks\\/[a-fA-F0-9_\\-]+\\/actions\\/?$ {\n  set $wkc_workflow_service wkc-workflow-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_set_header X-Forwarded-Port 31843;\n  proxy_pass https://$wkc_workflow_service:443;\n  proxy_read_timeout 30m;\n}\nlocation /v3/workflow_user_tasks {\n  set $wkc_workflow_service wkc-workflow-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_set_header X-Forwarded-Port 31843;\n  proxy_pass https://$wkc_workflow_service:443;\n}\nlocation /v3/workflow_configurations {\n  set $wkc_workflow_service wkc-workflow-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_set_header X-Forwarded-Port 31843;\n  proxy_pass https://$wkc_workflow_service:443;\n}\nlocation /v3/workflow_templates {\n  set $wkc_workflow_service wkc-workflow-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_set_header X-Forwarded-Port 31843;\n  proxy_pass https://$wkc_workflow_service:443;\n}\nlocation ~ ^\\/v3\\/governance_artifact_types\\/(category|glossary_term|policy|rule|data_class|classification)\\/import\\/?$ {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n  proxy_read_timeout 30m;\n}\nlocation /v3/governance_artifact_types {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n}\nlocation /v2/asset_lineages {\n  set $wdp_lineage wdp-lineage.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_lineage:443;\n}\nlocation /v2/lineage_events {\n  set $wdp_lineage wdp-lineage.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_lineage:443;\n}\nlocation /v2/transform {\n  set $wdp_policy_service wdp-policy-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_policy_service:443;\n}\nlocation /v2/policies {\n  set $wdp_policy_service wdp-policy-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_policy_service:443;\n}\nlocation /v2/policy_categories {\n  set $wdp_policy_service wdp-policy-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_policy_service:443;\n}\nlocation /v2/policy_taxonomies {\n  set $wdp_policy_service wdp-policy-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_policy_service:443;\n}\nlocation /v2/governance_types {\n  set $wdp_policy_service wdp-policy-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_policy_service:443;\n}\nlocation /v2/policy_terms {\n  set $wdp_policy_service wdp-policy-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_policy_service:443;\n}\nlocation /v2/policy_metrics {\n  set $wdp_policy_service wdp-policy-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_policy_service:443;\n}\nlocation /v2/policy_rules {\n  set $wdp_policy_service wdp-policy-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_policy_service:443;\n}\nlocation /v2/governed_items {\n  set $wdp_policy_service wdp-policy-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_policy_service:443;\n}\nlocation /v2/policy_audit_records {\n  set $wdp_policy_service wdp-policy-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_policy_service:443;\n}\nlocation /v3/enforcement {\n  set $wdp_policy_service wdp-policy-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wdp_policy_service:443;\n}\nlocation /v3/migrate {\n  set $wkc_glossary_service wkc-glossary-service.$nsdomain;\n  proxy_set_header Host $host;\n  proxy_pass https://$wkc_glossary_service:443;\n}\n"}}'
